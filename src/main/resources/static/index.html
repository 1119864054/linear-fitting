<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="">

    <title>Linear</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="dist/css/signin.css">
</head>

<body style="padding-bottom: 0;">
<div class="container">
    <div class="row">
        <div class="col-sm-8 blog-main">
            <div class="d-flex justify-content-between flex-wrap
                        flex-md-nowrap align-items-center pt-3 pb-2 mb-3
                        border-bottom">
                <h1 class="h2">线性回归分析</h1>
                <div class="btn-toolbar mb-2 mb-md-0">
                    <div class="btn-group mr-2">
                        <button type="button" class="btn btn-sm
                                    btn-outline-primary">上传当前数据
                        </button>
                        <button type="button" class="btn btn-sm
                                    btn-outline-secondary">上传文件
                        </button>
                    </div>
                </div>
            </div>
            <div style="height: 50vh;width: 100%;" id="main"></div>
            <h2>数据</h2>
            <div class="table-responsive">
                <table class="table table-striped table-sm">
                    <thead>
                    <tr>
                        <th>#</th>
                        <th>X</th>
                        <th>Y</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>1,006</td>
                        <td>nibh</td>
                        <td>elementum</td>
                    </tr>
                    <tr>
                        <td>1,007</td>
                        <td>sagittis</td>
                        <td>ipsum</td>
                    </tr>
                    <tr>
                        <td>1,008</td>
                        <td>Fusce</td>
                        <td>nec</td>
                    </tr>
                    <tr>
                        <td>1,009</td>
                        <td>augue</td>
                        <td>semper</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
            <div class="sidebar-module sidebar-module-inset" id="login_box">
                <div class="form-signin">
                    <ul class="nav">
                        <li class="nav-item">
                            <a class="nav-link disabled" href="#" id="login_tab"><h1 class="h3 mb-3 font-weight-normal"
                                                                                     aria-disabled="true">登录</h1></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#" tabindex="-1" aria-disabled="true" id="reg_tab"><h1
                                    class="h3 mb-3 font-weight-normal">注册</h1></a>
                        </li>
                    </ul>
                    <block id="login_form" style="display: block">
                        <label for="loginUsername" class="sr-only">Username
                            address</label>
                        <input type="text" id="loginUsername" class="form-control" placeholder="用户名" required
                               autofocus>
                        <label for="loginPassword" class="sr-only">Password</label>
                        <input type="password" id="loginPassword" class="form-control" placeholder="密码" required>
                        <small style="display: none" id="msg1" class="form-text text-danger">用户名密码不正确</small>
                        <button class="btn btn-sm btn-primary btn-block" id="login_btn">登录</button>
                    </block>
                    <block id="reg_form" style="display: none">
                        <label for="regUsername" class="sr-only">Username
                            address</label>
                        <input type="text" id="regUsername" class="form-control" placeholder="用户名" required
                               autofocus>
                        <label for="regPassword" class="sr-only">Password</label>
                        <input type="password" id="regPassword" class="form-control" placeholder="密码" required>
                        <small style="display: none" id="msg4" class="form-text text-danger">用户名不能为空</small>
                        <small style="display: none" id="msg6" class="form-text text-danger">密码不能为空</small>
                        <small style="display: none" id="msg5" class="form-text text-danger">用户名已存在</small>
                        <small style="display: none" id="msg2" class="form-text text-success">注册成功</small>
                        <small style="display: none" id="msg3" class="form-text text-info">已有相同用户名注册</small>
                        <button class="btn btn-sm btn-info btn-block" id="register_btn">注册</button>
                    </block>
                </div>
            </div>
        </div>
    </div>
</div>

</body>

</html>
<script src="https://cdn.bootcss.com/jquery/3.5.0/jquery.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous">
</script>
<script src="dist/js/echarts.js"></script>
<script src='./dist/js/ecStat.js'></script>
<script>
    function init() {
    }

    init();

    function removeSmallTxt() {
        $('#msg1').attr("style", "display:none");
        $('#msg2').attr("style", "display:none");
        $('#msg3').attr("style", "display:none");
        $('#msg4').attr("style", "display:none");
        $('#msg5').attr("style", "display:none");
        $('#msg6').attr("style", "display:none");
    }


    $("#regUsername").blur(function () {
        let username = $("#regUsername").val()
        if (username === "") {
            removeSmallTxt();
            $('#msg4').attr("style", "display:block");
        } else {
            $.ajax({
                url: "http://localhost:8080/demo/user/isExist",
                data: {
                    name: username
                },
                type: "GET",
                dataType: "json",
                ContentType: "application/json",
                success: function (res) {
                    console.log(res)
                    if (res.data) {
                        removeSmallTxt();
                        $('#msg5').attr("style", "display:block");
                    }
                }
            });
        }
    });

    $("#regPassword").blur(function () {
        let password = $("#regPassword").val()
        if (password === "") {
            removeSmallTxt();
            $('#msg6').attr("style", "display:block");
        } else {
            removeSmallTxt();
        }
    });

    function login_init() {
        $('#login_box').attr("style", "display:none");
    }

    $("#login_btn").click(function () {
        let username = $("#loginUsername").val()
        let password = $("#loginPassword").val()
        console.log(username)
        console.log(password)
        $.ajax({
            url: "http://localhost:8080/demo/user/login",
            data: {
                name: username,
                password: password
            },
            type: "GET",
            dataType: "json",
            ContentType: "application/json",
            success: function (res) {
                console.log(res)
                if (!res.data) {
                    removeSmallTxt();
                    $('#msg1').attr("style", "display:block");
                }
                login_init();
            }
        });
    });

    $("#register_btn").click(function () {
        let username = $("#regUsername").val()
        let password = $("#regPassword").val()
        console.log(username)
        console.log(password)
        $.ajax({
            url: "http://localhost:8080/demo/user/register",
            data: JSON.stringify({
                name: username,
                password: password
            }),
            type: "POST",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            success: function (res) {
                console.log(res)
                if (res.data) {
                    removeSmallTxt();
                    $('#msg2').attr("style", "display:block");
                } else {
                    removeSmallTxt();
                    $('#msg3').attr("style", "display:block");
                }
            }
        });
    });

    $("#login_tab").click(function () {
        $('#login_tab').attr("class", "nav-link disabled");
        $('#reg_tab').attr("class", "nav-link active");
        $('#login_form').attr("style", "display:block");
        $('#reg_form').attr("style", "display:none");
    });

    $("#reg_tab").click(function () {
        $('#login_tab').attr("class", "nav-link active");
        $('#reg_tab').attr("class", "nav-link disabled");
        $('#login_form').attr("style", "display:none");
        $('#reg_form').attr("style", "display:block");
    });

    let myChart = echarts.init(document.getElementById('main'));

    let data = [
        [1, 2],
        [3, 5],
        [4, 6],
        [4.5, 4]
    ];
    let myRegression = ecStat.regression('linear', data);
    console.log(myRegression.expression)

    myChart.setOption({
        toolbox: {
            feature: {
                saveAsImage: {},
                dataView: {}
            }
        },
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'cross'
            }
        },
        xAxis: {
            type: 'value',
            splitLine: {
                lineStyle: {
                    type: 'dashed'
                }
            },
        },
        yAxis: {
            type: 'value',
            min: 1.5,
            splitLine: {
                lineStyle: {
                    type: 'dashed'
                }
            },
        },
        series: [{
            name: 'scatter',
            type: 'scatter',
            label: {
                emphasis: {
                    show: true
                }
            },
            data: data
        }, {
            name: 'line',
            type: 'line',
            showSymbol: false,
            data: myRegression.points,
            markPoint: {
                itemStyle: {
                    normal: {
                        color: 'transparent'
                    }
                },
                label: {
                    normal: {
                        show: true,
                        position: 'left',
                        formatter: myRegression.expression,
                        textStyle: {
                            color: '#333',
                            fontSize: 14
                        }
                    }
                },
                data: [{
                    coord: myRegression.points[myRegression.points.length - 1]
                }]
            }
        }]
    });
    window.onresize = function () {
        myChart.resize();
    }

    //写cookies
    function setCookie(name, password) {
        let Days = 30;
        let exp = new Date();
        exp.setTime(exp.getTime() + Days * 24 * 60 * 60 * 1000);
        document.cookie = name + "=" + escape(password) + ";expires=" + exp.toGMTString();
    }

    //读取cookies
    function getCookie(name) {
        let arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");

        if (arr === document.cookie.match(reg))

            return unescape(arr[2]);
        else
            return null;
    }

    //删除cookies
    function delCookie(name) {
        let exp = new Date();
        exp.setTime(exp.getTime() - 1);
        let cval = getCookie(name);
        if (cval != null)
            document.cookie = name + "=" + cval + ";expires=" + exp.toGMTString();
    }
</script>

<!-- http://47.93.123.132/linear/demo/user/login -->